<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">


		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/docs/css/main.css">
		<link rel="apple-touch-icon" href="/docs/images/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/docs/images/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/docs/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/docs/"><img src="/docs/images/emblem.svg" width="40" height="40" alt="ATD文档中心 logo"></a>
				ATD文档中心
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>
			<!--
			<form action="/docs/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="搜索" autofocus>
				<input type="submit" value="search" style="display: none;">
			</form>
		-->
			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/docs/">ATD新手入门文档</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item "><a href="/docs/%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%AD%96%E7%95%A5%E8%AE%BE%E7%BD%AE/">高级计算模式的策略设置</a></li>
					
						<li class="nav-item "><a href="/docs/%E9%AB%98%E7%BA%A7%E6%90%9C%E7%B4%A2%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">高级搜索说明文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%87%A0%E7%A7%8D%E6%8E%A8%E6%97%A5%E5%BF%97%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D/">几种推日志方式介绍</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%AF%B9%E6%8A%97-%E9%AB%98%E7%BA%A7%E8%A7%84%E5%88%99/">可编程对抗-高级规则</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%AF%B9%E6%8A%97%E6%A8%A1%E5%9E%8B%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">可编程对抗模型说明文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%BD%AE%E8%AF%A2%E5%91%A8%E6%9C%9F%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">轮询周期使用文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%86%85%E7%BD%91%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">内网自定义处理接口文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E6%96%87%E6%A1%A3/">日志配置文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E7%AE%97%E6%B3%95%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">算法模型开发文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%BE%AE%E4%BF%A1%E5%91%8A%E8%AD%A6%E5%AF%B9%E6%8E%A5%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3/">微信告警对接操作文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E9%92%89%E9%92%89%E5%91%8A%E8%AD%A6%E5%AF%B9%E6%8E%A5%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3/">钉钉告警对接操作文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">运行环境自动调整接口文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">执行动作使用文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%99%BA%E8%83%BD%E6%97%A5%E5%BF%97%E8%A7%A3%E6%9E%90/">智能日志解析</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%B5%84%E4%BA%A7%E5%8F%91%E7%8E%B0/">资产发现</a></li>
					
						<li class="nav-item current"><a href="/docs/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">自定义处理方式接口开发文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%94%BB%E5%87%BB%E7%B1%BB%E5%9E%8B/">攻击类型</a></li>
					
						<li class="nav-item "><a href="/docs/FAQ/">FAQ</a></li>
					
				</ul>

			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>ATD文档中心</h2>
				<h3>自定义处理方式接口开发文档</h3>
			</div>
			<article class="content">
				<h3 id="说明">说明</h3>
<blockquote>
  <p>接口以POST方式调用，body格式为json。</p>
</blockquote>

<h3 id="1-request-body数据样例">1. request body数据样例</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo.baishancloud.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
       </span><span class="nl">"time_local"</span><span class="p">:</span><span class="w"> </span><span class="mi">1509379866</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"perspective_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ip"</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"perspective_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"210.45.137.29"</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"210.45.137.29"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/test/test.php"</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"path_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
       </span><span class="nl">"pv"</span><span class="p">:</span><span class="w"> </span><span class="mi">29</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"engine_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"policy"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CC攻击"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"url_pattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo.baishancloud.com/test/test.php"</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"expire"</span><span class="p">:</span><span class="w"> </span><span class="mi">1800</span><span class="p">,</span><span class="w">
       </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
       </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ban"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"in_white_list"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
       </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"中国"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"province"</span><span class="p">:</span><span class="w"> </span><span class="s2">"安徽"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"淮北"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"district"</span><span class="p">:</span><span class="w"> </span><span class="s2">"相山区"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"idc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"教育网"</span><span class="p">,</span><span class="w"> 
       </span><span class="nl">"export_ip"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
       </span><span class="nl">"ip_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">search_engine</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">status</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">},</span><span class="se">\"</span><span class="s2">is_near</span><span class="se">\"</span><span class="s2">: true,</span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">: [{</span><span class="se">\"</span><span class="s2">province</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">安徽</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">city</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">淮北</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">district</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">相山区</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">country</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">中国</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">location</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">latitude</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">33.989607</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">radius</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0.8171</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">longitude</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">116.820571</span><span class="se">\"</span><span class="s2">},</span><span class="se">\"</span><span class="s2">idc</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">教育网</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">accuracy</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">街道级</span><span class="se">\"</span><span class="s2">}],</span><span class="se">\"</span><span class="s2">cache_at</span><span class="se">\"</span><span class="s2">: 1509379866,</span><span class="se">\"</span><span class="s2">export_score</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">60</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">ip</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">210.45.137.29</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">credit</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">user_count</span><span class="se">\"</span><span class="s2">: 1,</span><span class="se">\"</span><span class="s2">office</span><span class="se">\"</span><span class="s2">: 47.68,</span><span class="se">\"</span><span class="s2">family</span><span class="se">\"</span><span class="s2">: 37.990000000000002,</span><span class="se">\"</span><span class="s2">export_ip</span><span class="se">\"</span><span class="s2">: 10,</span><span class="se">\"</span><span class="s2">person</span><span class="se">\"</span><span class="s2">: 10.01,</span><span class="se">\"</span><span class="s2">dirty</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0.00</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">active</span><span class="se">\"</span><span class="s2">: 0,</span><span class="se">\"</span><span class="s2">base_station</span><span class="se">\"</span><span class="s2">: 3.16, </span><span class="se">\"</span><span class="s2">edu_station</span><span class="se">\"</span><span class="s2">: 3.16},</span><span class="se">\"</span><span class="s2">is_virus</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_abuse</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">is_spider</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">is_spam</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_legal</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_black</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_data_center</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_proxy</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_tor</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">is_wangba</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">trend</span><span class="se">\"</span><span class="s2">: [[1520218800, 2, </span><span class="se">\"</span><span class="s2">low</span><span class="se">\"</span><span class="s2">],[1520218800, 3, </span><span class="se">\"</span><span class="s2">low</span><span class="se">\"</span><span class="s2">]],</span><span class="se">\"</span><span class="s2">score</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">low</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">撞库</span><span class="se">\"</span><span class="s2">: 3, </span><span class="se">\"</span><span class="s2">爬虫</span><span class="se">\"</span><span class="s2">: 5},</span><span class="se">\"</span><span class="s2">latest</span><span class="se">\"</span><span class="s2">: [{</span><span class="se">\"</span><span class="s2">timestamp</span><span class="se">\"</span><span class="s2">: 1520218800, </span><span class="se">\"</span><span class="s2">hits</span><span class="se">\"</span><span class="s2">: 8, </span><span class="se">\"</span><span class="s2">score</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">low</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">爬虫</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">loc</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">上海</span><span class="se">\"</span><span class="s2">}]}"</span><span class="w">
      </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>字段解释：</strong></p>

<table>
  <thead>
    <tr>
      <th>字段名</th>
      <th>类型</th>
      <th>取值范围</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>host</td>
      <td>string</td>
      <td>-</td>
      <td>域名</td>
    </tr>
    <tr>
      <td>info</td>
      <td>array</td>
      <td>-</td>
      <td>拦截数据数组</td>
    </tr>
    <tr>
      <td>info[0].time_local</td>
      <td>int</td>
      <td>-</td>
      <td>unix 时间戳</td>
    </tr>
    <tr>
      <td>info[0].perspective_name</td>
      <td>enum</td>
      <td>[“ip”,”id”]</td>
      <td>分析维度的名称，目前ATD支持的分析维度有IP和ID两种，其中ID为用户指定的user_id、device_id等可以唯一标示一个用户的ID</td>
    </tr>
    <tr>
      <td>info[0].perspective_value</td>
      <td>string</td>
      <td>-</td>
      <td>分析维度的值</td>
    </tr>
    <tr>
      <td>info[0].ip</td>
      <td>string</td>
      <td>-</td>
      <td>当分析维度为IP时，值为攻击IP；当分析维度不为IP时，攻击IP可能为多个，所以值为攻击IP列表，多IP之间以,分割</td>
    </tr>
    <tr>
      <td>info[0].path</td>
      <td>string</td>
      <td>-</td>
      <td>被访问最多的路径</td>
    </tr>
    <tr>
      <td>info[0].path_count</td>
      <td>int</td>
      <td>-</td>
      <td>被访问最多路径的请求数</td>
    </tr>
    <tr>
      <td>info[0].pv</td>
      <td>int</td>
      <td>-</td>
      <td>本次时间窗⼝内的总请求数</td>
    </tr>
    <tr>
      <td>info[0].engine_type</td>
      <td>enum</td>
      <td>[“policy”,”deep”,”learning”]</td>
      <td>识别本次攻击的算法引擎的名称，policy：实时引擎，deep：深度引擎，learning：学习引擎</td>
    </tr>
    <tr>
      <td>info[0].reason</td>
      <td>string</td>
      <td>-</td>
      <td>命中的攻击类型，目前ATD可以识别的攻击类型包括：爬虫、账号类攻击、CC攻击、慢速攻击、异常流量包攻击、刷单类攻击、路径扫描、危险UA、SQL注入、命令注入、跨站脚本、异常路径访问等</td>
    </tr>
    <tr>
      <td>info[0].url_pattern</td>
      <td>string</td>
      <td>-</td>
      <td>路径特征，具有相同结构的url用url_pattern表示，如www.abc.com/a/123.html和www.abc.com/a/456.html的url_pattern为www.abc.com/a/*.html</td>
    </tr>
    <tr>
      <td>info[0].expire</td>
      <td>int</td>
      <td>[60-86400]</td>
      <td>被拦截IP禁用时长，IP每次被识别为威胁拦截时的禁用时长，单位为：秒。禁用时长到期后，IP解禁可继续访问</td>
    </tr>
    <tr>
      <td>info[0].score</td>
      <td>int</td>
      <td>[1-100]</td>
      <td>威胁分数，1-25为疑似，26-55为低威胁，56-85为中威胁，86-100为高威胁</td>
    </tr>
    <tr>
      <td>info[0].action</td>
      <td>string</td>
      <td>-</td>
      <td>命中的攻击判定策略配置的处理动作</td>
    </tr>
  </tbody>
</table>

<p><strong>以下数据只在perspective_name为ip时有效：</strong></p>

<table>
  <thead>
    <tr>
      <th>字段名</th>
      <th>类型</th>
      <th>取值范围</th>
      <th>解释</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>info[0].in_white_list</td>
      <td>boolean</td>
      <td>[true,false]</td>
      <td>是否在⽩名单中</td>
    </tr>
    <tr>
      <td>info[0].country</td>
      <td>string</td>
      <td>-</td>
      <td>国家</td>
    </tr>
    <tr>
      <td>info[0].province</td>
      <td>string</td>
      <td>-</td>
      <td>省</td>
    </tr>
    <tr>
      <td>info[0].city</td>
      <td>string</td>
      <td>-</td>
      <td>市</td>
    </tr>
    <tr>
      <td>info[0].district</td>
      <td>string</td>
      <td>-</td>
      <td>区</td>
    </tr>
    <tr>
      <td>info[0].idc</td>
      <td>string</td>
      <td>-</td>
      <td>机房或网络运营商</td>
    </tr>
    <tr>
      <td>info[0].is_data_center</td>
      <td>enum</td>
      <td>[“yes”, “no”]</td>
      <td>是否是数据中心/云服务商</td>
    </tr>
    <tr>
      <td>info[0].export_ip</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>人群出口IP的概率，返回的数据中省略了%，推荐参考值，当该值大于60时可以认为是人群出口IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit</td>
      <td>object</td>
      <td>-</td>
      <td>IP信⽤等级数据，json格式，需解析</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_local</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>是否为内网IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.search_engine</td>
      <td>object</td>
      <td>-</td>
      <td>搜索引擎IP信息</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.search_engine.status</td>
      <td>enum</td>
      <td>[“yes”,”no”,””]</td>
      <td>当前IP是否为健康的搜索引擎爬虫IP，”yes”：健康的搜索引擎IP，”no”：恶意的搜索引擎IP，”“：不是搜索引擎IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.search_engine.name</td>
      <td>string</td>
      <td>-</td>
      <td>具体的搜索引擎名称</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_near</td>
      <td>boolean</td>
      <td>[true,false]</td>
      <td>内部临时数据，可忽略</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr</td>
      <td>array</td>
      <td>-</td>
      <td>IP地址信息</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].province</td>
      <td>string</td>
      <td>-</td>
      <td>省份</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].city</td>
      <td>string</td>
      <td>-</td>
      <td>城市</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].district</td>
      <td>string</td>
      <td>-</td>
      <td>地区</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].country</td>
      <td>string</td>
      <td>-</td>
      <td>国家</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].location</td>
      <td>object</td>
      <td>-</td>
      <td>IP地理位置信息</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].location.latitude</td>
      <td>float</td>
      <td>-</td>
      <td>IP的纬度</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].location.radius</td>
      <td>float</td>
      <td>-</td>
      <td>IP覆盖范围半径，单位：KM</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].location.longitude</td>
      <td>float</td>
      <td>-</td>
      <td>IP的经度</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].idc</td>
      <td>string</td>
      <td>-</td>
      <td>机房或网络运营商</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.addr[0].accuracy</td>
      <td>enum</td>
      <td>[“洲”,”国家”,”省”,”城市”,”区县”,”街道”]</td>
      <td>地理位置的精确度</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.cache_at</td>
      <td>int</td>
      <td>-</td>
      <td>内部临时数据，可忽略</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.export_score</td>
      <td>string</td>
      <td>-</td>
      <td>内部临时数据，可忽略</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.ip</td>
      <td>string</td>
      <td>-</td>
      <td>返回的IP,如果</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit</td>
      <td>object</td>
      <td>-</td>
      <td>IP信用数据</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.user_count</td>
      <td>int</td>
      <td>[1-9]</td>
      <td>人数范围标识：’1’:’1’，’2’:’2-5’，’3’:’6-10’，’4’:’11-30’，’5’:’31-50’，’6’:’51-100’，’7’:’101-500’，’8’:’501-2000’，’9’:’2000+’</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.office</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为办公网的概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.family</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为住宅小区的概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.export_ip</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为人群出口的概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.person</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为真人的概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.dirty</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP的污点概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.active</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP的活跃度</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.base_station</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP是基站的概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.credit.edu_station</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP是教育网的概率</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_virus</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有病毒标签</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_abuse</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有恶意活动标签</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_spider</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有爬虫标签</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_spam</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有垃圾邮件标签</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_legal</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否符合语法标准</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_black</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为高危IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_data_center</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为数据中心IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_proxy</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为代理IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_tor</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为洋葱路由IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.is_wangba</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为网吧IP</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.trend</td>
      <td>array</td>
      <td>-</td>
      <td>威胁趋势</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.trend[0][0]</td>
      <td>int</td>
      <td>-</td>
      <td>日期0点时间戳</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.trend[0][1]</td>
      <td>int</td>
      <td>-</td>
      <td>记录数量</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.trend[0][2]</td>
      <td>enum</td>
      <td>[“low”,”medium”,”high”,null]</td>
      <td>威胁等级</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.score</td>
      <td>enum</td>
      <td>[“low”,”medium”,”high”,null]</td>
      <td>威胁等级</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.type</td>
      <td>dict</td>
      <td>-</td>
      <td>历史威胁事件名称和计数的key-val对</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.latest</td>
      <td>array</td>
      <td>-</td>
      <td>近期威胁事件记录</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.latest[0].timestamp</td>
      <td>int</td>
      <td>-</td>
      <td>更新时间戳</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.latest[0].hits</td>
      <td>int</td>
      <td>-</td>
      <td>命中次数</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.latest[0].score</td>
      <td>enum</td>
      <td>[“low”,”medium”,”high”,null]</td>
      <td>威胁等级</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.latest[0].type</td>
      <td>string</td>
      <td>-</td>
      <td>威胁事件名称</td>
    </tr>
    <tr>
      <td>info[0].ip_credit.latest[0].loc</td>
      <td>string</td>
      <td>-</td>
      <td>攻击源地理位置</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>说明：<br />
在ATD中，当某IP的人群出口IP概率值（info[0].export_ip）大于60时，认为是人群出口IP。</p>
</blockquote>

<h3 id="2-response-body数据样例">2. response body数据样例</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>字段解释：</strong></p>

<table>
  <thead>
    <tr>
      <th>字段名</th>
      <th>类型</th>
      <th>取值范围</th>
      <th>解释</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>code</td>
      <td>int</td>
      <td>-</td>
      <td>调⽤结果， 0表示成功，⾮0表示失败</td>
    </tr>
    <tr>
      <td>msg</td>
      <td>string</td>
      <td>-</td>
      <td>提示信息</td>
    </tr>
    <tr>
      <td>data</td>
      <td>array</td>
      <td>-</td>
      <td>⽤于返回结果数据，这⾥填空数组即可</td>
    </tr>
  </tbody>
</table>

<h3 id="3-调用示例">3. 调用示例</h3>

<blockquote>
  <p>说明：<br />
1、在验证时，我们将向您发送如上样例的POST数据包；<br />
2、如果在3秒内返回结果，并且（1）返回的数据为JSON格式；（2）code值为0，则将验证通过。<br /></p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@bs203 ~]# curl http://172.18.1.203:8001/v1/firewall/action -d '
{
    "host": "demo.baishancloud.com",
    "info": [{
       "time_local": 1509379866, 
       "perspective_name": "ip", 
       "perspective_value": "210.45.137.29", 
       "ip": "210.45.137.29",
       "path": "/test/test.php", 
       "path_count": 1,
       "pv": 29, 
       "engine_type": "policy",
       "reason": "CC攻击",
       "url_pattern": "demo.baishancloud.com/test/test.php", 
       "expire": 1800,
       "score": 80,
       "action": "ban",
       "in_white_list": false,
       "country": "中国",
       "province": "安徽",
       "city": "淮北",
       "district": "相山区",
       "idc": "教育网", 
       "export_ip": 10,
       "ip_credit": "{\"is_local\": \"no\",\"search_engine\": {\"status\": \"\",\"name\": \"\"},\"is_near\": true,\"addr\": [{\"province\": \"安徽\",\"city\": \"淮北\",\"district\": \"相山区\",\"country\": \"中国\",\"location\": {\"latitude\": \"33.989607\",\"radius\": \"0.8171\",\"longitude\": \"116.820571\"},\"idc\": \"教育网\",\"accuracy\": \"街道级\"}],\"cache_at\": 1509379866,\"export_score\": \"60\",\"ip\": \"210.45.137.29\",\"credit\": {\"user_count\": 1,\"office\": 47.68,\"family\": 37.990000000000002,\"export_ip\": 10,\"person\": 10.01,\"dirty\": \"0.00\",\"active\": 0, \"base_station\": 3.16, \"edu_station\": 3.16},\"is_virus\": \"no\",\"is_abuse\": \"no\", \"is_spider\": \"no\", \"is_spam\": \"no\",\"is_legal\": \"yes\",\"is_black\": \"yes\",\"is_data_center\": \"no\",\"is_proxy\": \"no\",\"is_tor\": \"no\",\"is_wangba\": \"no\",\"trend\": [[1520218800, 2, \"low\"],[1520218800, 3, \"low\"]],\"score\": \"low\",\"type\": {\"撞库\": 3, \"爬虫\": 5},\"latest\": [{\"timestamp\": 1520218800, \"hits\": 8, \"score\": \"low\", \"type\": \"爬虫\", \"loc\": \"上海\"}]}"
      }]
}
'
{
    "msg": "success", 
    "code": 0, 
    "data": []
}
</code></pre></div></div>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
